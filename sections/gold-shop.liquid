<!-- GLORY SHOP - SPEND LEADERBOARD GOLD -->
<div class="glory-shop-wrapper">
  <div class="shop-header">
    <h1 class="rpg-title">üèÜ C·ª¨A H√ÄNG DANH V·ªåNG</h1>
    <p class="rpg-sub">D√πng GOLD t·ª´ B·∫£ng X·∫øp H·∫°ng ƒë·ªÉ ƒë·ªïi l·∫•y v·∫≠t ph·∫©m MI·ªÑN PH√ç 100%</p>
    
    <div class="gold-balance-display">
      T√ÄI S·∫¢N: <span id="user-gold-display" style="color:#ffd700; font-size:1.8em;">0</span> GOLD ü™ô
    </div>
    <p style="font-size:12px; color:#666; margin-top:5px;">(Gold ƒë∆∞·ª£c t·ªïng k·∫øt t·ª´ Leaderboard h√†ng tu·∫ßn)</p>
  </div>

  <!-- L∆Ø·ªöI S·∫¢N PH·∫®M -->
  <div class="glory-grid" id="glory-grid-render"></div>
</div>

<!-- MODAL X√ÅC NH·∫¨N MUA -->
<div id="glory-modal" class="rpg-modal-overlay">
  <div class="rpg-modal-box">
    <div style="font-size:50px; margin-bottom:10px;">üëë</div>
    <h3 id="modal-title" style="color:#ffd700">X√ÅC NH·∫¨N ƒê·ªîI</h3>
    <p id="modal-msg" style="color:#ccc;">B·∫°n c√≥ mu·ªën d√πng Gold ƒë·ªÉ ƒë·ªïi m√≥n n√†y?</p>
    
    <!-- Code Box -->
    <div id="glory-code-display" class="code-box" style="display:none;" onclick="copyGloryCode()">CODE</div>
    
    <div id="modal-actions" style="margin-top:20px;">
      <button id="btn-confirm-glory" class="rpg-btn">ƒê·ªîI NGAY</button>
      <button onclick="closeGloryModal()" class="rpg-btn-secondary">ƒê√ìNG</button>
    </div>
  </div>
</div>

<style>
  /* GIAO DI·ªÜN SANG TR·ªåNG (V√†ng + ƒêen) */
  .glory-shop-wrapper {
    background-color: #0a0a0c; 
    background-image: radial-gradient(circle at 50% 0%, #2a1a00 0%, #000 80%);
    color: #fff; padding: 60px 20px;
    min-height: 100vh; font-family: 'Cinzel', serif; text-align: center;
  }
  .rpg-title { color: #ffd700; text-shadow: 0 0 20px #ffd700; margin-bottom: 10px; font-size: 2.5rem; }
  .rpg-sub { color: #aaa; margin-bottom: 30px; font-family: sans-serif; }
  
  .gold-balance-display {
    background: linear-gradient(90deg, #000, #332200, #000);
    border: 2px solid #ffd700;
    display: inline-block; padding: 15px 40px; border-radius: 4px;
    font-weight: bold; font-size: 1.2em;
    box-shadow: 0 0 30px rgba(255, 215, 0, 0.2);
  }

  .glory-grid {
    display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 30px; max-width: 1000px; margin: 50px auto;
  }

  .glory-card {
    background: #111; border: 1px solid #444; border-radius: 8px;
    padding: 30px 20px; transition: 0.3s; position: relative;
    display: flex; flex-direction: column; align-items: center;
  }
  .glory-card:hover { transform: translateY(-10px); border-color: #ffd700; box-shadow: 0 0 25px rgba(255, 215, 0, 0.3); }
  
  .item-icon { font-size: 70px; margin-bottom: 20px; filter: drop-shadow(0 0 10px gold); }
  .item-name { font-size: 1.4em; font-weight: bold; color: #fff; margin-bottom: 5px; }
  .item-desc { font-size: 0.9em; color: #888; margin-bottom: 20px; min-height: 40px;}
  .item-price { color: #ffd700; font-weight: bold; font-size: 1.2em; margin-bottom: 20px; display: block; border: 1px solid #ffd700; padding: 5px 15px; border-radius: 20px; }
  
  .buy-btn {
    width: 100%; padding: 15px; background: linear-gradient(to bottom, #ffd700, #b8860b);
    border: none; color: #000; font-weight: bold; cursor: pointer; text-transform: uppercase; font-family: 'Cinzel', serif; font-size: 1rem;
  }
  .buy-btn:hover { filter: brightness(1.2); }
  .buy-btn.disabled { background: #333; color: #666; cursor: not-allowed; }

  /* Modal */
  .rpg-modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 99999; display: none; justify-content: center; align-items: center; }
  .rpg-modal-box { background: #0f0f0f; border: 2px solid #ffd700; padding: 40px; width: 400px; text-align: center; border-radius: 4px; box-shadow: 0 0 50px rgba(255,215,0,0.2); }
  .code-box { background: #222; border: 2px dashed #2ecc71; padding: 20px; margin-top: 20px; color: #2ecc71; font-size: 2em; font-weight: bold; cursor: pointer; }
  .rpg-btn { background: #ffd700; color: #000; border: none; padding: 10px 30px; font-weight: bold; cursor: pointer; }
  .rpg-btn-secondary { background: transparent; border: 1px solid #777; color: #ccc; padding: 10px 30px; cursor: pointer; margin-left: 10px; }
</style>

<script>
  // DANH S√ÅCH V·∫¨T PH·∫®M ƒê·ªîI B·∫∞NG GOLD (M√£ gi·∫£m gi√° 100%)
  // B·∫°n c·∫ßn t·∫°o c√°c m√£ n√†y trong Admin: FREE_SWORD, FREE_ARMOR...
  const GLORY_ITEMS = [
    { id: 1, name: "Ki·∫øm R·ªìng (Legendary)", desc: "V≈© kh√≠ c·∫•p huy·ªÅn tho·∫°i. Mi·ªÖn ph√≠ 100%.", price: 5000, icon: "‚öîÔ∏è", code: "FREE_DRAGON_SWORD" },
    { id: 2, name: "Gi√°p Ho√†ng Kim", desc: "B·ªô gi√°p c·ªßa Vua. Mi·ªÖn ph√≠ 100%.", price: 8000, icon: "üõ°Ô∏è", code: "FREE_GOLD_ARMOR" },
    { id: 3, name: "C√°nh Thi√™n Th·∫ßn", desc: "Skin c√°nh si√™u hi·∫øm. Mi·ªÖn ph√≠ 100%.", price: 15000, icon: "ü™Ω", code: "FREE_ANGEL_WINGS" },
    { id: 4, name: "R∆∞∆°ng Th·∫ßn B√≠", desc: "Set qu√† b√≠ m·∫≠t tr·ªã gi√° 5 tri·ªáu.", price: 30000, icon: "üéÅ", code: "FREE_MYSTERY_BOX" }
  ];

  // Key l∆∞u tr·ªØ Gold (Ph·∫£i kh·ªõp v·ªõi key m√† Leaderboard c·ªông v√†o)
  const KEY_GOLD = 'rpg_local_gold'; 
  
  let userGold = 0;
  let selectedItem = null;

  document.addEventListener("DOMContentLoaded", function() {
    loadGloryShop();
  });

  function loadGloryShop() {
    // 1. L·∫•y Gold (t·ª´ Leaderboard t√≠ch l≈©y)
    userGold = parseInt(localStorage.getItem(KEY_GOLD) || 0);
    document.getElementById('user-gold-display').innerText = userGold.toLocaleString();

    // 2. Render
    const grid = document.getElementById('glory-grid-render');
    grid.innerHTML = '';

    GLORY_ITEMS.forEach(item => {
      const canBuy = userGold >= item.price;
      const btnState = canBuy ? '' : 'disabled';
      const btnText = canBuy ? 'ƒê·ªîI NGAY' : 'CH∆ØA ƒê·ª¶ GOLD';
      
      grid.innerHTML += `
        <div class="glory-card">
          <div class="item-icon">${item.icon}</div>
          <div class="item-name">${item.name}</div>
          <div class="item-desc">${item.desc}</div>
          <span class="item-price">ü™ô ${item.price.toLocaleString()} GOLD</span>
          <button class="buy-btn ${btnState}" onclick="confirmGloryBuy(${item.id})">${btnText}</button>
        </div>
      `;
    });
  }

  function confirmGloryBuy(id) {
    selectedItem = GLORY_ITEMS.find(i => i.id === id);
    if(selectedItem) {
      document.getElementById('glory-modal').style.display = 'flex';
      document.getElementById('modal-title').innerText = "X√ÅC NH·∫¨N";
      document.getElementById('modal-msg').innerText = `D√πng ${selectedItem.price.toLocaleString()} Gold ƒë·ªÉ ƒë·ªïi ${selectedItem.name}?`;
      
      document.getElementById('btn-confirm-glory').style.display = 'inline-block';
      document.getElementById('btn-confirm-glory').onclick = processGloryTransaction;
      document.getElementById('glory-code-display').style.display = 'none';
    }
  }

  function processGloryTransaction() {
    // 1. Tr·ª´ Gold
    userGold -= selectedItem.price;
    localStorage.setItem(KEY_GOLD, userGold);
    
    loadGloryShop();

    // 2. Hi·ªán Code
    document.getElementById('modal-title').innerText = "TH√ÄNH C√îNG!";
    document.getElementById('modal-msg').innerText = "V·∫≠t ph·∫©m ƒë√£ thu·ªôc v·ªÅ b·∫°n. H√£y d√πng m√£ n√†y:";
    
    const codeBox = document.getElementById('glory-code-display');
    codeBox.style.display = 'block';
    codeBox.innerText = selectedItem.code;
    
    document.getElementById('btn-confirm-glory').style.display = 'none';
  }

  function closeGloryModal() { document.getElementById('glory-modal').style.display = 'none'; }
  function copyGloryCode() { navigator.clipboard.writeText(document.getElementById('glory-code-display').innerText); alert("ƒê√£ copy m√£!"); }
</script>

{% schema %}
{
  "name": "Glory Shop (Gold)",
  "settings": [],
  "presets": [{"name": "Glory Shop (Gold)"}]
}
{% endschema %}